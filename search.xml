<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>电子时钟</title>
    <url>/2021/03/28/%E7%94%B5%E5%AD%90%E6%97%B6%E9%92%9F/</url>
    <content><![CDATA[<p>#基于stc51单片机的电子时钟设计</p>
<span id="more"></span>

<p><strong>以下内容均个人所写仅供参考，如有错误欢迎指正，欢迎大家交流学习。纯属个人分享 不喜勿喷。谢谢</strong></p>
<h2 id="1-系统功能简介"><a href="#1-系统功能简介" class="headerlink" title="1.系统功能简介"></a>1.系统功能简介</h2><h3 id="1-1硬件介绍"><a href="#1-1硬件介绍" class="headerlink" title="1.1硬件介绍"></a>1.1硬件介绍</h3><p>  本系统由ds1302时钟芯片产生时基掉电可用后备电源不影响时间准确<a href="https://wenku.baidu.com/view/1c014a0616fc700abb68fc45.html">关于ds1302</a>，蜂鸣器用于闹钟（也可用温度报警本系统没有），ds18b20数字温度传感器用于检测环境温度<a href="http://www.21ic.com/jichuzhishi/datasheet/DS18B20/data/187578.html">关于ds18b20</a>，24c02芯片是IIC时序的存储器用于存储用户信息，整个系统的显示用的是LCD12864（串口的）,整个系统均由stc90c516协调控制。</p>
<h3 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h3><ul>
<li>可按键调整时间</li>
<li>能显示精确温度</li>
<li>可设置当前时间24小时以内的闹钟</li>
<li>ds1302电路<br><img src="https://img-blog.csdnimg.cn/20200219130449685.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpeXVueHVsaQ==,size_16,color_FFFFFF,t_70" alt="注意：ds1302内置匹配电容6pf所以X1晶振要买6pf的晶振"></li>
<li>24c02电路<br><img src="https://img-blog.csdnimg.cn/20200219130631692.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpeXVueHVsaQ==,size_16,color_FFFFFF,t_70" alt="1,2，3引脚为IIC地址信号线要加4.7K上拉电阻"></li>
<li>完整电路图和PCB<code>见文末</code><h2 id="2-程序"><a href="#2-程序" class="headerlink" title="2.程序"></a>2.程序</h2>运行环境win10  keil5<br>由于代码量过大这里主要介绍主函数和按键功能实现函数其余代码<code>见文末</code></li>
<li><strong>main.h</strong>，引入标准头文件和数据类型重命名</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _MAIN_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _MAIN_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;reg52.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;intrins.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> uchar unsigned char</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> uint unsigned int 	</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ulong unsigned long</span></span><br><span class="line">	</span><br><span class="line">sbit beep = P1^<span class="number">5</span>;<span class="comment">//蜂鸣器控制引脚定义</span></span><br><span class="line">	</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ds1302init 0   <span class="comment">//ds1302初始化时间标志</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Delay10ms</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> c)</span></span>;<span class="comment">//10ms延时</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>main.c</strong></li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;main.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;lcd.h&quot;</span>			<span class="comment">//显示头文件</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;ds1302.h&quot;</span>			<span class="comment">//温度传感器</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;24c02.h&quot;</span>			<span class="comment">//存储</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;ds18b20.h&quot;</span>		<span class="comment">//时钟</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;key.h&quot;</span>			<span class="comment">//按键</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Delay10ms</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> a,b;</span><br><span class="line">    <span class="keyword">for</span>(;c&gt;<span class="number">0</span>;c--)</span><br><span class="line">        <span class="keyword">for</span>(b=<span class="number">38</span>;b&gt;<span class="number">0</span>;b--)</span><br><span class="line">            <span class="keyword">for</span>(a=<span class="number">130</span>;a&gt;<span class="number">0</span>;a--);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;	 </span><br><span class="line">	uchar b = <span class="number">50</span>,n=<span class="number">10</span>;</span><br><span class="line">	TMOD|=<span class="number">0X01</span>;							<span class="comment">//选择为定时器0模式，工作方式1，仅用TR0打开启动。</span></span><br><span class="line">	TH0 = <span class="number">0xff</span>;</span><br><span class="line">	TL0 = <span class="number">0x9c</span>;</span><br><span class="line">	ET0 = <span class="number">1</span>;</span><br><span class="line">	EA = <span class="number">1</span>;										<span class="comment">//使用定时器0中断</span></span><br><span class="line">	Init_lcd();</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">if</span> ds1302init 								<span class="comment">//是否初始化时间</span></span></span><br><span class="line">		Init_ds1302();</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	clear_all();</span><br><span class="line">	display_graphic_8x16(<span class="number">1</span>,<span class="number">1</span>,&amp;num[<span class="number">2</span>][<span class="number">0</span>]);</span><br><span class="line">	display_graphic_8x16(<span class="number">1</span>,<span class="number">8</span>,&amp;num[<span class="number">0</span>][<span class="number">0</span>]);</span><br><span class="line">	display_graphic_8x16(<span class="number">3</span>,<span class="number">8</span>*<span class="number">12</span>,O);</span><br><span class="line">	display_graphic_8x16(<span class="number">3</span>,<span class="number">8</span>*<span class="number">13</span>,F);</span><br><span class="line">	display_graphic_8x16(<span class="number">3</span>,<span class="number">8</span>*<span class="number">14</span>,F);</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		At24c02Write(<span class="number">1</span>,<span class="number">0x00</span>);</span><br><span class="line">		<span class="keyword">if</span>(At24c02Read(<span class="number">1</span>) == <span class="number">0x00</span>)</span><br><span class="line">			display_graphic_16x16(<span class="number">3</span>,<span class="number">8</span>*<span class="number">14</span>,ri);</span><br><span class="line">		Key_Function(Key_Read()); 					<span class="comment">//按键读取函数并实现相应功能</span></span><br><span class="line">		<span class="keyword">if</span>(n == <span class="number">10</span>) 								<span class="comment">//延时控制</span></span><br><span class="line">		&#123;</span><br><span class="line">			time_display();  						 <span class="comment">//时间显示函数</span></span><br><span class="line">			n=<span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(b == <span class="number">50</span>) 								<span class="comment">//延时控制</span></span><br><span class="line">		&#123;</span><br><span class="line">			Ds18b20_display(Ds18b20ReadTemp());     <span class="comment">//温度显示函数</span></span><br><span class="line">			b=<span class="number">0</span>;		</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(clock[<span class="number">2</span>] == <span class="number">0x01</span>) 						<span class="comment">//判断闹钟标志</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(Alarm_clock[<span class="number">0</span>] == time[<span class="number">2</span>])    		<span class="comment">//检查闹钟是否到时</span></span><br><span class="line">			&#123;			</span><br><span class="line">				<span class="keyword">if</span>(Alarm_clock[<span class="number">1</span>] == time[<span class="number">1</span>])</span><br><span class="line">				&#123;</span><br><span class="line">					TR0 = <span class="number">1</span>;  						<span class="comment">//开启定时器0</span></span><br><span class="line">					clear_8x16(<span class="number">3</span>,<span class="number">8</span>*<span class="number">13</span>);</span><br><span class="line">					display_graphic_8x16(<span class="number">3</span>,<span class="number">8</span>*<span class="number">13</span>,F);</span><br><span class="line">					display_graphic_8x16(<span class="number">3</span>,<span class="number">8</span>*<span class="number">14</span>,F);</span><br><span class="line">					clear_8x16(<span class="number">5</span>,<span class="number">8</span>*<span class="number">3</span>);</span><br><span class="line">					clear_8x16(<span class="number">5</span>,<span class="number">8</span>*<span class="number">4</span>);</span><br><span class="line">					clear_8x16(<span class="number">5</span>,<span class="number">8</span>*<span class="number">5</span>);</span><br><span class="line">					clear_8x16(<span class="number">5</span>,<span class="number">8</span>*<span class="number">6</span>);</span><br><span class="line">					clear_8x16(<span class="number">5</span>,<span class="number">8</span>*<span class="number">7</span>);</span><br><span class="line">					clock[<span class="number">2</span>] = <span class="number">0x00</span>;</span><br><span class="line">					clock[<span class="number">0</span>] = <span class="number">0x00</span>;</span><br><span class="line">					clock[<span class="number">1</span>] = <span class="number">0x00</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		Delay10ms(<span class="number">1</span>);</span><br><span class="line">		b++;</span><br><span class="line">		n++;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Timer0</span><span class="params">()</span> interrupt 1  		<span class="comment">//中断服务函数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">static</span> uint i;</span><br><span class="line">	TH0=<span class="number">0xff</span>;	</span><br><span class="line">	TL0=<span class="number">0x9c</span>;</span><br><span class="line">	beep = ~beep;				<span class="comment">//蜂鸣器</span></span><br><span class="line">	i++;</span><br><span class="line">	<span class="keyword">if</span>(i==<span class="number">15000</span>)   				<span class="comment">//可调整想多长时间</span></span><br><span class="line">	&#123;</span><br><span class="line">		i=<span class="number">0</span>;</span><br><span class="line">		TR0 = <span class="number">0</span>;</span><br><span class="line">	&#125;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>key.h</strong></li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _KEY_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _KEY_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;main.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">sbit ADD = P3^<span class="number">2</span>;  		<span class="comment">//加</span></span><br><span class="line">sbit RED = P3^<span class="number">3</span>;		<span class="comment">//减		</span></span><br><span class="line">sbit ALARM = P3^<span class="number">4</span>;		<span class="comment">//闹钟</span></span><br><span class="line">sbit SET = P3^<span class="number">5</span>;		<span class="comment">//设置</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ADD_1	1		<span class="comment">//加返回值</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RED_2	2		<span class="comment">//减返回值</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ALARM_3	3		<span class="comment">//闹钟返回值</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SET_4	4		<span class="comment">//设置返回值</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> uchar clock[<span class="number">3</span>];			<span class="comment">//clock[0]接收小时数据  clock[1]接收分钟数据 clock[2]是进入闹钟标志</span></span><br><span class="line"><span class="keyword">extern</span> uchar Alarm_clock[<span class="number">2</span>];	<span class="comment">//闹钟的时，分</span></span><br><span class="line"></span><br><span class="line"><span class="function">uchar <span class="title">Key_Read</span><span class="params">(<span class="keyword">void</span>)</span></span>;			<span class="comment">//读取按键值的函数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Key_Function</span><span class="params">(uchar temp)</span></span>;	<span class="comment">//根据按键值实现功能的函数</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>key.c</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;key.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;lcd.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;ds1302.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;24c02.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">uchar clock[<span class="number">3</span>];  		<span class="comment">//clock[0]接收小时数据  clock[1]接收分钟数据 clock[2]是进入闹钟标志</span></span><br><span class="line">uchar Alarm_clock[<span class="number">2</span>]; 	<span class="comment">//闹钟的时，分</span></span><br><span class="line"></span><br><span class="line"><span class="function">uchar <span class="title">Key_Read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>((ADD == <span class="number">0</span>) || (RED == <span class="number">0</span>) || (ALARM == <span class="number">0</span>) || (SET) == <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		Delay10ms(<span class="number">1</span>); 	<span class="comment">//延时去抖动</span></span><br><span class="line">		<span class="keyword">if</span>(ADD == <span class="number">0</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">while</span>(!ADD);</span><br><span class="line">			<span class="keyword">return</span> ADD_1;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(RED == <span class="number">0</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">while</span>(!RED);</span><br><span class="line">			<span class="keyword">return</span> RED_2;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(ALARM == <span class="number">0</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">while</span>(!ALARM);</span><br><span class="line">			<span class="keyword">return</span> ALARM_3;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(SET == <span class="number">0</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">while</span>(!SET);</span><br><span class="line">			<span class="keyword">return</span> SET_4;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;  <span class="comment">//如果无则返回0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/********************************************************</span></span><br><span class="line"><span class="comment">数值加一函数</span></span><br><span class="line"><span class="comment">参数一用于按键检查 如果检查不对直接退出函数</span></span><br><span class="line"><span class="comment">参数二用于修改那个时间比如 i=1 则修改年，i=2 则修改月 以此类推</span></span><br><span class="line"><span class="comment">time全局外部数组 在ds1303.c中定义，顺序是 秒，分，时，日，月，星期，年</span></span><br><span class="line"><span class="comment">无返回值</span></span><br><span class="line"><span class="comment">*************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span>  <span class="title">Add_one</span><span class="params">(uchar temp,uchar i)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(temp == ADD_1)<span class="comment">//加一</span></span><br><span class="line">	&#123;</span><br><span class="line">		Write_ds1302(<span class="number">0x8e</span>,<span class="number">0x00</span>);	<span class="comment">//关闭写保护</span></span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(i == <span class="number">1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>((time[<span class="number">6</span>] &amp; <span class="number">0x0f</span>) == <span class="number">0x09</span>)  <span class="comment">//判断是否需要进位 比如19到20  以下均是</span></span><br><span class="line">			&#123;</span><br><span class="line">				time[<span class="number">6</span>] &gt;&gt;= <span class="number">4</span>;  </span><br><span class="line">				time[<span class="number">6</span>] ++;</span><br><span class="line">				time[<span class="number">6</span>] &lt;&lt;= <span class="number">4</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				time[<span class="number">6</span>]++;</span><br><span class="line">			Write_ds1302(<span class="number">0x8c</span>,time[<span class="number">6</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(i == <span class="number">2</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>((time[<span class="number">4</span>] &amp; <span class="number">0x0f</span>) == <span class="number">0x09</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				time[<span class="number">4</span>] &gt;&gt;= <span class="number">4</span>;</span><br><span class="line">				time[<span class="number">4</span>] ++;</span><br><span class="line">				time[<span class="number">4</span>] &lt;&lt;= <span class="number">4</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				time[<span class="number">4</span>]++;</span><br><span class="line">			<span class="keyword">if</span>(time[<span class="number">4</span>] == <span class="number">0x13</span>)</span><br><span class="line">				time[<span class="number">4</span>] = <span class="number">0x01</span>;</span><br><span class="line">			Write_ds1302(<span class="number">0x88</span>,time[<span class="number">4</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(i == <span class="number">3</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>((time[<span class="number">3</span>] &amp; <span class="number">0x0f</span>) == <span class="number">0x09</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				time[<span class="number">3</span>] &gt;&gt;= <span class="number">4</span>;</span><br><span class="line">				time[<span class="number">3</span>] ++;</span><br><span class="line">				time[<span class="number">3</span>] &lt;&lt;= <span class="number">4</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				time[<span class="number">3</span>]++;</span><br><span class="line">			<span class="keyword">if</span>(time[<span class="number">3</span>] == <span class="number">0x32</span>)</span><br><span class="line">				time[<span class="number">3</span>] = <span class="number">0x01</span>;</span><br><span class="line">			Write_ds1302(<span class="number">0x86</span>,time[<span class="number">3</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(i == <span class="number">4</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			time[<span class="number">5</span>]++;</span><br><span class="line">			<span class="keyword">if</span>(time[<span class="number">5</span>] == <span class="number">0x08</span>)</span><br><span class="line">				time[<span class="number">5</span>] = <span class="number">0x01</span>;</span><br><span class="line">			Write_ds1302(<span class="number">0x8a</span>,time[<span class="number">5</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(i == <span class="number">5</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>((time[<span class="number">2</span>] &amp; <span class="number">0x0f</span>) == <span class="number">0x09</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				time[<span class="number">2</span>] &gt;&gt;= <span class="number">4</span>;</span><br><span class="line">				time[<span class="number">2</span>] ++;</span><br><span class="line">				time[<span class="number">2</span>] &lt;&lt;= <span class="number">4</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				time[<span class="number">2</span>]++;</span><br><span class="line">			<span class="keyword">if</span>(time[<span class="number">2</span>] == <span class="number">0x24</span>)</span><br><span class="line">				time[<span class="number">2</span>] = <span class="number">0x00</span>;</span><br><span class="line">			Write_ds1302(<span class="number">0x84</span>,time[<span class="number">2</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(i == <span class="number">6</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>((time[<span class="number">1</span>] &amp; <span class="number">0x0f</span>) == <span class="number">0x09</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				time[<span class="number">1</span>] &gt;&gt;= <span class="number">4</span>;</span><br><span class="line">				time[<span class="number">1</span>] ++;</span><br><span class="line">				time[<span class="number">1</span>] &lt;&lt;= <span class="number">4</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				time[<span class="number">1</span>]++;</span><br><span class="line">			<span class="keyword">if</span>(time[<span class="number">1</span>] == <span class="number">0x60</span>)</span><br><span class="line">				time[<span class="number">1</span>] = <span class="number">0x00</span>;</span><br><span class="line">			Write_ds1302(<span class="number">0x82</span>,time[<span class="number">1</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(i == <span class="number">7</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>((time[<span class="number">0</span>] &amp; <span class="number">0x0f</span>) == <span class="number">0x09</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				time[<span class="number">0</span>] &gt;&gt;= <span class="number">4</span>;</span><br><span class="line">				time[<span class="number">0</span>] ++;</span><br><span class="line">				time[<span class="number">0</span>] &lt;&lt;= <span class="number">4</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				time[<span class="number">0</span>]++;</span><br><span class="line">			<span class="keyword">if</span>(time[<span class="number">0</span>] == <span class="number">0x60</span>)</span><br><span class="line">				time[<span class="number">0</span>] = <span class="number">0x00</span>;</span><br><span class="line">			Write_ds1302(<span class="number">0x80</span>,time[<span class="number">0</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		Write_ds1302(<span class="number">0x8e</span>,<span class="number">0x80</span>);  <span class="comment">//打开写保护</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/********************************************************</span></span><br><span class="line"><span class="comment">数值减一函数</span></span><br><span class="line"><span class="comment">参数一用于按键检查 如果检查不对直接退出函数</span></span><br><span class="line"><span class="comment">参数二用于修改那个时间比如 i=1 则修改年，i=2 则修改月 以此类推</span></span><br><span class="line"><span class="comment">time全局外部数组 在ds1303.c中定义，顺序是 秒，分，时，日，月，星期，年</span></span><br><span class="line"><span class="comment">无返回值</span></span><br><span class="line"><span class="comment">*************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Red_one</span><span class="params">(uchar temp,uchar i)</span></span></span><br><span class="line"><span class="function"></span>&#123;		</span><br><span class="line">	<span class="keyword">if</span>(temp == RED_2)</span><br><span class="line">	&#123;</span><br><span class="line">		Write_ds1302(<span class="number">0x8e</span>,<span class="number">0x00</span>);<span class="comment">//关闭写保护</span></span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(i == <span class="number">1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>((time[<span class="number">6</span>] &amp; <span class="number">0x0f</span>) == <span class="number">0x00</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				time[<span class="number">6</span>] &gt;&gt;= <span class="number">4</span>;</span><br><span class="line">				time[<span class="number">6</span>] --;</span><br><span class="line">				time[<span class="number">6</span>] &lt;&lt;= <span class="number">4</span>;</span><br><span class="line">				time[<span class="number">6</span>] |= <span class="number">0x09</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				time[<span class="number">6</span>]--;</span><br><span class="line">			Write_ds1302(<span class="number">0x8c</span>,time[<span class="number">6</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(i == <span class="number">2</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>((time[<span class="number">4</span>] &amp; <span class="number">0x0f</span>) == <span class="number">0x00</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				time[<span class="number">4</span>] &gt;&gt;= <span class="number">4</span>;</span><br><span class="line">				time[<span class="number">4</span>] --;</span><br><span class="line">				time[<span class="number">4</span>] &lt;&lt;= <span class="number">4</span>;</span><br><span class="line">				time[<span class="number">4</span>] |= <span class="number">0x09</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				time[<span class="number">4</span>]--;</span><br><span class="line">			<span class="keyword">if</span>(time[<span class="number">4</span>] == <span class="number">0x00</span>)</span><br><span class="line">				time[<span class="number">4</span>] = <span class="number">0x12</span>;</span><br><span class="line">			Write_ds1302(<span class="number">0x88</span>,time[<span class="number">4</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(i == <span class="number">3</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>((time[<span class="number">3</span>] &amp; <span class="number">0x0f</span>) == <span class="number">0x00</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				time[<span class="number">3</span>] &gt;&gt;= <span class="number">4</span>;</span><br><span class="line">				time[<span class="number">3</span>] --;</span><br><span class="line">				time[<span class="number">3</span>] &lt;&lt;= <span class="number">4</span>;</span><br><span class="line">				time[<span class="number">3</span>] |= <span class="number">0x09</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				time[<span class="number">3</span>]--;</span><br><span class="line">			<span class="keyword">if</span>(time[<span class="number">3</span>] == <span class="number">0x00</span>)</span><br><span class="line">				time[<span class="number">3</span>] = <span class="number">0x31</span>;</span><br><span class="line">			Write_ds1302(<span class="number">0x86</span>,time[<span class="number">3</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(i == <span class="number">4</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			time[<span class="number">5</span>]--;</span><br><span class="line">			<span class="keyword">if</span>(time[<span class="number">5</span>] == <span class="number">0x00</span>)</span><br><span class="line">				time[<span class="number">5</span>] = <span class="number">0x07</span>;</span><br><span class="line">			Write_ds1302(<span class="number">0x8a</span>,time[<span class="number">5</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(i == <span class="number">5</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>((time[<span class="number">2</span>] &amp; <span class="number">0x0f</span>) == <span class="number">0x00</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				time[<span class="number">2</span>] &gt;&gt;= <span class="number">4</span>;</span><br><span class="line">				time[<span class="number">2</span>] --;</span><br><span class="line">				time[<span class="number">2</span>] &lt;&lt;= <span class="number">4</span>;</span><br><span class="line">				time[<span class="number">2</span>] |= <span class="number">0x09</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				time[<span class="number">2</span>]--;</span><br><span class="line">			Write_ds1302(<span class="number">0x84</span>,time[<span class="number">2</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(i == <span class="number">6</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>((time[<span class="number">1</span>] &amp; <span class="number">0x0f</span>) == <span class="number">0x00</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				time[<span class="number">1</span>] &gt;&gt;= <span class="number">4</span>;</span><br><span class="line">				time[<span class="number">1</span>] --;</span><br><span class="line">				time[<span class="number">1</span>] &lt;&lt;= <span class="number">4</span>;</span><br><span class="line">				time[<span class="number">1</span>] |= <span class="number">0x09</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				time[<span class="number">1</span>]--;</span><br><span class="line">			Write_ds1302(<span class="number">0x82</span>,time[<span class="number">1</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(i == <span class="number">7</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>((time[<span class="number">0</span>] &amp; <span class="number">0x0f</span>) == <span class="number">0x00</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				time[<span class="number">0</span>] &gt;&gt;= <span class="number">4</span>;</span><br><span class="line">				time[<span class="number">0</span>] --;</span><br><span class="line">				time[<span class="number">0</span>] &lt;&lt;= <span class="number">4</span>;</span><br><span class="line">				time[<span class="number">0</span>] |= <span class="number">0x09</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				time[<span class="number">0</span>]--;</span><br><span class="line">			Write_ds1302(<span class="number">0x80</span>,time[<span class="number">0</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		Write_ds1302(<span class="number">0x8e</span>,<span class="number">0x80</span>);  <span class="comment">//打开写保护</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/********************************************************</span></span><br><span class="line"><span class="comment">按键功能实现函数（调整时间，闹钟）</span></span><br><span class="line"><span class="comment">参数一用于检查是哪个功能</span></span><br><span class="line"><span class="comment">无返回值</span></span><br><span class="line"><span class="comment">*************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Key_Function</span><span class="params">(uchar temp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">static</span> uchar i = <span class="number">0</span>,k = <span class="number">0</span>,filg = <span class="number">1</span>,filg1 = <span class="number">1</span>,j = <span class="number">0</span>,s = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(((k == <span class="number">1</span>) || (temp == SET_4)) &amp;&amp; (filg == <span class="number">1</span>))<span class="comment">//进入设置时间模式</span></span><br><span class="line">	&#123;</span><br><span class="line">		filg1 = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span>(temp == SET_4)  <span class="comment">//实现调整时间闪烁提示</span></span><br><span class="line">			i++;</span><br><span class="line">		k = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">switch</span>(i)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">1</span>:clear_8x16(<span class="number">1</span>,<span class="number">8</span>*<span class="number">2</span>); clear_8x16(<span class="number">1</span>,<span class="number">8</span>*<span class="number">3</span>); <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">2</span>:clear_8x16(<span class="number">1</span>,<span class="number">8</span>*<span class="number">6</span>); clear_8x16(<span class="number">1</span>,<span class="number">8</span>*<span class="number">7</span>); <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">3</span>:clear_8x16(<span class="number">1</span>,<span class="number">8</span>*<span class="number">10</span>); clear_8x16(<span class="number">1</span>,<span class="number">8</span>*<span class="number">11</span>); <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">4</span>:clear_8x16(<span class="number">1</span>,<span class="number">8</span>*<span class="number">15</span>); <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">5</span>:clear_8x16(<span class="number">3</span>,<span class="number">8</span>*<span class="number">3</span>); clear_8x16(<span class="number">3</span>,<span class="number">8</span>*<span class="number">4</span>); <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">6</span>:clear_8x16(<span class="number">3</span>,<span class="number">8</span>*<span class="number">6</span>); clear_8x16(<span class="number">3</span>,<span class="number">8</span>*<span class="number">7</span>); <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">7</span>:clear_8x16(<span class="number">3</span>,<span class="number">8</span>*<span class="number">9</span>); clear_8x16(<span class="number">3</span>,<span class="number">8</span>*<span class="number">10</span>); <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">8</span>:i = <span class="number">0</span>; k = <span class="number">0</span>; filg1 = <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		Add_one(temp,i);</span><br><span class="line">		Red_one(temp,i);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(((s == <span class="number">1</span>) || (temp == ALARM_3)) &amp;&amp; (filg1 == <span class="number">1</span>))<span class="comment">//设置闹钟时间</span></span><br><span class="line">	&#123;</span><br><span class="line">		s = <span class="number">1</span>;</span><br><span class="line">		clock[<span class="number">2</span>] = <span class="number">0x01</span>; <span class="comment">//进入闹钟标志置一</span></span><br><span class="line">		<span class="keyword">if</span>(k == <span class="number">0</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			</span><br><span class="line">			clock[<span class="number">0</span>] = time[<span class="number">2</span>];</span><br><span class="line">			clock[<span class="number">1</span>] = time[<span class="number">1</span>];</span><br><span class="line">			clear_8x16(<span class="number">3</span>,<span class="number">8</span>*<span class="number">13</span>);  <span class="comment">//清除OFF 的前两个字母</span></span><br><span class="line">			clear_8x16(<span class="number">3</span>,<span class="number">8</span>*<span class="number">14</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		filg = <span class="number">0</span>;</span><br><span class="line">		k = <span class="number">1</span>;</span><br><span class="line">		display_graphic_8x16(<span class="number">3</span>,<span class="number">8</span>*<span class="number">13</span>,N); <span class="comment">//显示ON</span></span><br><span class="line">		display_graphic_8x16(<span class="number">5</span>,<span class="number">8</span>*<span class="number">3</span>,&amp;num[(clock[<span class="number">0</span>] / <span class="number">16</span>)][<span class="number">0</span>]);</span><br><span class="line">		display_graphic_8x16(<span class="number">5</span>,<span class="number">8</span>*<span class="number">4</span>,&amp;num[(clock[<span class="number">0</span>] &amp; <span class="number">0x0f</span>)][<span class="number">0</span>]);</span><br><span class="line">		display_graphic_8x16(<span class="number">5</span>,<span class="number">8</span>*<span class="number">5</span>,mao_hao);</span><br><span class="line">		display_graphic_8x16(<span class="number">5</span>,<span class="number">8</span>*<span class="number">6</span>,&amp;num[(clock[<span class="number">1</span>] / <span class="number">16</span>)][<span class="number">0</span>]);</span><br><span class="line">		display_graphic_8x16(<span class="number">5</span>,<span class="number">8</span>*<span class="number">7</span>,&amp;num[(clock[<span class="number">1</span>] &amp; <span class="number">0x0f</span>)][<span class="number">0</span>]);</span><br><span class="line">		<span class="keyword">if</span>(temp == SET_4)  <span class="comment">//计数按了几次</span></span><br><span class="line">			j++;</span><br><span class="line">		<span class="keyword">switch</span>(j)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">1</span>:clear_8x16(<span class="number">5</span>,<span class="number">8</span>*<span class="number">3</span>);clear_8x16(<span class="number">5</span>,<span class="number">8</span>*<span class="number">4</span>);<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">2</span>:clear_8x16(<span class="number">5</span>,<span class="number">8</span>*<span class="number">6</span>);clear_8x16(<span class="number">5</span>,<span class="number">8</span>*<span class="number">7</span>);<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">3</span>:filg = <span class="number">1</span>; s = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(j == <span class="number">1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(temp == ADD_1)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span>((clock[<span class="number">0</span>] &amp; <span class="number">0x0f</span>) == <span class="number">0x09</span>) <span class="comment">//判断是否需要进位 比如19到20</span></span><br><span class="line">				&#123;</span><br><span class="line">					clock[<span class="number">0</span>] &gt;&gt;= <span class="number">4</span>;</span><br><span class="line">					clock[<span class="number">0</span>] ++;</span><br><span class="line">					clock[<span class="number">0</span>] &lt;&lt;= <span class="number">4</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span></span><br><span class="line">					clock[<span class="number">0</span>]++;</span><br><span class="line">			&#125;			</span><br><span class="line">			<span class="keyword">if</span>(temp == RED_2)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span>((clock[<span class="number">0</span>] &amp; <span class="number">0x0f</span>) == <span class="number">0x00</span>)</span><br><span class="line">				&#123;</span><br><span class="line">					clock[<span class="number">0</span>] &gt;&gt;= <span class="number">4</span>;</span><br><span class="line">					clock[<span class="number">0</span>] --;</span><br><span class="line">					clock[<span class="number">0</span>] &lt;&lt;= <span class="number">4</span>;</span><br><span class="line">					clock[<span class="number">0</span>] |= <span class="number">0x09</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span></span><br><span class="line">					clock[<span class="number">0</span>]--;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(j == <span class="number">2</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(temp == ADD_1)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span>((clock[<span class="number">1</span>] &amp; <span class="number">0x0f</span>) == <span class="number">0x09</span>)</span><br><span class="line">				&#123;</span><br><span class="line">					clock[<span class="number">1</span>] &gt;&gt;= <span class="number">4</span>;</span><br><span class="line">					clock[<span class="number">1</span>] ++;</span><br><span class="line">					clock[<span class="number">1</span>] &lt;&lt;= <span class="number">4</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span></span><br><span class="line">					clock[<span class="number">1</span>]++;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(temp == RED_2)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span>((clock[<span class="number">1</span>] &amp; <span class="number">0x0f</span>) == <span class="number">0x00</span>)</span><br><span class="line">				&#123;</span><br><span class="line">					clock[<span class="number">1</span>] &gt;&gt;= <span class="number">4</span>;</span><br><span class="line">					clock[<span class="number">1</span>] --;</span><br><span class="line">					clock[<span class="number">1</span>] &lt;&lt;= <span class="number">4</span>;</span><br><span class="line">					clock[<span class="number">1</span>] |= <span class="number">0x09</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span></span><br><span class="line">					clock[<span class="number">1</span>]--;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(j == <span class="number">3</span>) <span class="comment">//表示设置闹钟完成 设置值存入全局数组</span></span><br><span class="line">		&#123;</span><br><span class="line">			Alarm_clock[<span class="number">1</span>] = clock[<span class="number">1</span>];</span><br><span class="line">			Alarm_clock[<span class="number">0</span>] = clock[<span class="number">0</span>];</span><br><span class="line">			j = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>下面我对以上代码思路做简单介绍。如要所有代码<code>见文末</code></strong></p>
<p>   程序采用C语言的模块化思想把功能封装成函数，主函数主要实现所用硬件的初始化定时器中断和所有需要显示到LCD上的内容。ds1302初始时间只需要设置一次因为掉电程序会重新运行但是时间掉电也会运行所以时间不需要初始化我们采用条件编译来实现。ds1302读回来的时间放在一个可供所有文件使用的全局数组<code>time</code>里。<br>  key.c主要介绍按键功能实现的函数这个函数实现两个功能调整时间和设置闹钟时间（最好把这两个功能写成两个独立的函数，也不知道当时我是咋想的☹☹）进入设置后利用加一减一函数实现加减在通过time数组写给ds1302就能够设置时间，关于怎么知道你当前设置的是那一个时间我用了局部清屏之后在写然后在局部清屏实现局部屏幕闪烁提示用户当前正在修改那个时间。</p>
<hr>
<p>  （<strong>最会说一下该程序的bug第一次开机必须先按下设置时间键才能按下闹钟键否则按下闹钟键没反应我实在是写吐了如有大神谢谢指点</strong>）<br>请点击<a href="https://pan.baidu.com/s/1lFCvCxWeM8TZdQaGqZYlhA">源码+原理图+pcb</a>提取码w1kb</p>
]]></content>
  </entry>
  <entry>
    <title>使用hexo搭建个人博客</title>
    <url>/2021/01/29/%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/</url>
    <content><![CDATA[<p>#使用hexo搭建个人博客</p>
<span id="more"></span>

<h1 id="git的安装和使用"><a href="#git的安装和使用" class="headerlink" title="git的安装和使用"></a>git的安装和使用</h1><p>这也是搭建个人博客的第一步，同时在项目的开发中也可以在git上托管自己的代码，简单总结一下git的安装和GitHub的配置。</p>
<h2 id="下载安装Git"><a href="#下载安装Git" class="headerlink" title="下载安装Git"></a>下载安装Git</h2><ol>
<li>下载git 官方地址为：<a href="https://git-scm.com/download/win">https://git-scm.com/download/win</a> </li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/sudo-li/pic/img/Snipaste_2021-01-29_17-40-42.jpg" alt="Git下载界面"><br>2. 下载完成后开始安装Git （就一直下一步就可以）注意一下选择组件界面即可 一直到安装完成<br><img src="https://cdn.jsdelivr.net/gh/sudo-li/pic/img/2.jpg"><br>3. 检验一下是否安装成功 （如果出现了Get GUI 和 Get Bash两个就成功安装了）<br><img src="https://cdn.jsdelivr.net/gh/sudo-li/pic/img/18-34-05.jpg">  </p>
<h2 id="简单的配置和使用git"><a href="#简单的配置和使用git" class="headerlink" title="简单的配置和使用git"></a>简单的配置和使用git</h2><p>在做git的初始化之前需要去GitHub上注册账户并登录，<a href="https://github.com/">GitHub</a></p>
<ol>
<li>在任意位置创建一个文件夹，在文件空白区域右击，点击刚刚安装的Git Bash Here，做一些基本的信息配置 <ol>
<li>设置用户名:<blockquote>
<p>$ git config –global user.name ‘你在Github上注册的用户名’;</p>
</blockquote>
</li>
<li>设置邮箱： <blockquote>
<p>$ git config –global user.email ‘注册时候邮箱’;</p>
</blockquote>
</li>
<li>设置成功后可使用如下命令查看是否成功<blockquote>
<p>$ git config –list  </p>
</blockquote>
</li>
</ol>
</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/sudo-li/pic/img/18-57-02.jpg"><br>2. 初始化一个新的git仓库  </p>
<blockquote>
<p>$ git int<br>3. gitd的几个常用的命令<br>git add ‘文件名’  ;将文件添加到文件暂存区<br>git status    ;查看文件的状态<br>git commit -m ‘描述说明’  ;把文件暂存区的文件提交到git仓库中 所有文件的增删改都需要提交<br>git rm ‘文件名’  ;删除一个文件</p>
</blockquote>
<hr>
<h1 id="安装Node-js"><a href="#安装Node-js" class="headerlink" title="安装Node.js"></a>安装Node.js</h1><p><a href="https://nodejs.org/en/">下载地址</a><br><img src="https://cdn.jsdelivr.net/gh/sudo-li/pic/img/19-11-08.jpg"><br>安装过程一直下一步就好了<br>整个过程都是在git Bash Here中进行的<br>检测node是否安装成功 </p>
<blockquote>
<p>$ node -v<br>  返回版本号<br>$ npm -v<br>  返回版本号</p>
</blockquote>
<h1 id="安装Hexo"><a href="#安装Hexo" class="headerlink" title="安装Hexo"></a>安装Hexo</h1><ol>
<li>安装淘宝镜像源（如果错误就重来）  <blockquote>
<p>$ npm install -g cnpm –registry=<a href="https://registry.npm.taobao.org/">https://registry.npm.taobao.org</a><br>检测<br>$ cnpm -v<br>返回版本号<br>安装hexo<br>$ cnpm install -g hexo-cli<br>检测<br>$ hexo -v<br>返回版本信息<br><img src="https://cdn.jsdelivr.net/gh/sudo-li/pic/img/19-20-05.jpg">  </p>
</blockquote>
</li>
<li>初始化hexo<br>在本地新建名为blog的文件夹（文件夹名可以任意）在文件夹内启动git Bash Here 然后执行  <blockquote>
<p>$ hexo init &nbsp;&nbsp;&nbsp;&nbsp;此过程需要等一会<br>结束后就可以启动hexo了<br>$ hexo s&nbsp;&nbsp;&nbsp;启动<br><img src="https://cdn.jsdelivr.net/gh/sudo-li/pic/img/Snipaste_2021-01-29_19-27-05.jpg"><br><a href="http://localhost:4000/">http://localhost:4000</a><br>这样就可以在本地的4000端口查看自己的网站了</p>
</blockquote>
</li>
</ol>
]]></content>
  </entry>
  <entry>
    <title>Ubuntu20.04美化过程</title>
    <url>/2021/03/31/ubuntu20.04%E7%BE%8E%E5%8C%96/</url>
    <content><![CDATA[<h1 id="Ubuntu美化过程"><a href="#Ubuntu美化过程" class="headerlink" title="Ubuntu美化过程"></a>Ubuntu美化过程</h1><span id="more"></span>

<h1 id="Ubuntu美化"><a href="#Ubuntu美化" class="headerlink" title="Ubuntu美化"></a>Ubuntu美化</h1><hr>
<h2 id="安装必要的软件"><a href="#安装必要的软件" class="headerlink" title="安装必要的软件"></a>安装必要的软件</h2><p>Ubuntu美化有几个必要的软件</p>
<ul>
<li>gnome-tweak-tool: 美化工具，设置主题，图标什么的的都在里面</li>
<li>gnome-shell-extensions: 启用gnome扩展</li>
<li>chrome-gnome-shell: 使用浏览器安装gnome扩展，不一定非要是chrome浏览器，并且不推荐chrome浏览器，因为需要安装浏览器扩展，而chrome浏览器安装扩展在国内是被404的，所以推荐使用Firefox浏览器<h2 id="系统选择界面的美化（开机的选项界面）"><a href="#系统选择界面的美化（开机的选项界面）" class="headerlink" title="系统选择界面的美化（开机的选项界面）"></a>系统选择界面的美化（开机的选项界面）</h2>在<a href="https://www.gnome-look.org/browse/cat/">gnome look</a>网站上下的Grub Themes 进入目录执行以下命令就可以了<blockquote>
<p>sudo ./install/sh</p>
</blockquote>
<h2 id="图标安装"><a href="#图标安装" class="headerlink" title="图标安装"></a>图标安装</h2>在<a href="https://www.gnome-look.org/browse/cat/">gnome look</a>网站上下的Full Icon Themes标签下现在喜欢的图标，下载完成后解压，将解压的目录放到家目录下的.icons文件夹。（推荐Tela）<h2 id="主题安装"><a href="#主题安装" class="headerlink" title="主题安装"></a>主题安装</h2>在<a href="https://www.gnome-look.org/browse/cat/">gnome look</a>网站上下的GTK3 Themes标签下现在喜欢的主题，下载完成后解压，将解压的目录放到家目录下的.themes文件夹。（推荐Orchis 和 McMojave）<h2 id="鼠标图标安装"><a href="#鼠标图标安装" class="headerlink" title="鼠标图标安装"></a>鼠标图标安装</h2>在<a href="https://www.gnome-look.org/browse/cat/">gnome look</a>网站上下的Cursors标签下现在喜欢的鼠标主题，下载完成后解压，将解压的目录放到系统的icons文件夹(/usr/share/icons)。（推荐Vimix cursors theme）</li>
</ul>
<hr>
<p>这些全都安装完成之后可以打开一个叫优化的软件，也就是我们一开始安装的gnome-tweak-tool，进行一下设置（其中shell设置需要先安装gnome扩展——User themes，详见gnome扩展设置）</p>
<h2 id="gnome扩展设置"><a href="#gnome扩展设置" class="headerlink" title="gnome扩展设置"></a>gnome扩展设置</h2><p>使用浏览器打开<a href="https://extensions.gnome.org/%EF%BC%8C%E6%8E%A8%E8%8D%90%E4%BD%BF%E7%94%A8Firefox%E6%B5%8F%E8%A7%88%E5%99%A8%EF%BC%8C%E7%82%B9%E5%87%BB%E7%BD%91%E7%AB%99%E4%B8%8A%E7%9A%84**Click">https://extensions.gnome.org/，推荐使用Firefox浏览器，点击网站上的**Click</a> here to install browser extension**，然后按照提示安装浏览器插件。插件安装完成后就可以使用浏览器安装gnome扩展了。<br>我主要安装了以下扩展  </p>
<ul>
<li>User Themes 必备插件，让你可以使用用户主题</li>
<li>dash to dock: 让你拥有跟macos一样的dock栏</li>
<li>Compiz alike windows effect：让你的窗口像果冻一样</li>
<li>Remove Alt+Tab Delay: 移除使用alt+tab切换窗口时的0.15秒的延迟，让你切换更加丝滑</li>
<li>ArcMenu：一个应用程序的菜单，可以选择各种风格的菜单栏</li>
</ul>
<p>然后打开extensions软件，可以开关上面安装的gnome extension，或者点击小齿轮进行更加细致的设置。</p>
]]></content>
      <tags>
        <tag>随笔</tag>
      </tags>
  </entry>
  <entry>
    <title>质数筛查</title>
    <url>/2021/03/29/%E8%B4%A8%E6%95%B0%E7%AD%9B%E6%9F%A5/</url>
    <content><![CDATA[<hr>
<span id="more"></span>  


<h1 id="质数筛查"><a href="#质数筛查" class="headerlink" title="质数筛查"></a>质数筛查</h1><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n = <span class="number">1000000</span>;</span><br><span class="line"><span class="keyword">int</span> mark[<span class="number">1000001</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> c;</span><br><span class="line">    <span class="keyword">int</span> m;</span><br><span class="line">    <span class="built_in">memset</span>(mark, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(mark));</span><br><span class="line">    mark[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    mark[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (c = <span class="number">2</span>; c * c &lt;= n; c++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (mark[c] != <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">2</span>; j &lt;= n / c; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                mark[c * j] = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = m; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (mark[i] == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对于n以内的筛选来说，如果n是和数，c为n的最小正因数，则有</p>
<blockquote>
<p>1 &lt;= c &lt;= sqrt(n) = 1 &lt;= pow(c,2) &lt;= n</p>
</blockquote>
<p>通过把和数用mark数组标记出来 来筛查质数</p>
]]></content>
      <categories>
        <category>C</category>
      </categories>
  </entry>
  <entry>
    <title>排序算法</title>
    <url>/2021/03/29/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/</url>
    <content><![CDATA[<h1 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a>冒泡排序</h1><span id="more"></span>

<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">for</span> (i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="selector-tag">for</span> (m = <span class="number">0</span>; m &lt; n - i - <span class="number">1</span>; m++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="selector-tag">if</span> (numbers[m + <span class="number">1</span>] &gt; numbers[m])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="selector-tag">swap</span>(&amp;numbers[m], &amp;numbers[m + <span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="选择排序"><a href="#选择排序" class="headerlink" title="选择排序"></a>选择排序</h1><figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">for (i = <span class="number">0</span>; i &lt; <span class="built_in">n</span> - <span class="number">1</span>; i++)</span><br><span class="line">&#123; </span><br><span class="line">    <span class="built_in">int</span> <span class="built_in">max</span> = i;</span><br><span class="line">    for (m = i + <span class="number">1</span>; m &lt; <span class="built_in">n</span>; m++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">if</span> (numbers[<span class="built_in">max</span>] &lt; numbers[m])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">max</span> = m;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">if</span>(i != <span class="built_in">max</span>)</span><br><span class="line">        swap(&amp;numbers[i], &amp;numbers[<span class="built_in">max</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>C</category>
      </categories>
  </entry>
  <entry>
    <title>二分查找</title>
    <url>/2021/03/29/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/</url>
    <content><![CDATA[<hr>
<span id="more"></span>

<figure class="highlight perl"><table><tr><td class="code"><pre><span class="line"> <span class="keyword">while</span>(low &lt;= high)</span><br><span class="line">&#123;</span><br><span class="line">    mid = (low + high) / <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span> (numbers[mid] == m)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">printf</span>(<span class="string">&quot;%d&quot;</span>, mid + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (numbers[mid] &lt; m)</span><br><span class="line">    &#123;</span><br><span class="line">        low = mid + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        high = mid - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(low &gt; high)</span><br><span class="line">    <span class="keyword">printf</span>(<span class="string">&quot;%d&quot;</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>C</category>
      </categories>
  </entry>
  <entry>
    <title>第一天</title>
    <url>/2021/03/29/%E7%AC%AC%E4%B8%80%E5%A4%A9/</url>
    <content><![CDATA[<h1 id="第一天"><a href="#第一天" class="headerlink" title="第一天"></a>第一天</h1><span id="more"></span>

<h1 id="1-inttypes-h"><a href="#1-inttypes-h" class="headerlink" title="1.inttypes.h"></a>1.inttypes.h</h1><ul>
<li>在C99中新添加的头文件  </li>
<li>新增了 int8_t int16_t int32_t int64_t  </li>
<li>访问的时候 printf(“%” PRId16,int16_t)  </li>
<li>新增了INT16_MAX INT16_MIN  <h1 id="2-区分左右值"><a href="#2-区分左右值" class="headerlink" title="2.区分左右值"></a>2.区分左右值</h1></li>
<li>在程序执行完上一行之后还可以访问的到的就是左值 否则为（中间的临时变量比如a+b产生的临时变量）右值    </li>
<li>注意从右到左的运算符 （++ – * &amp; ！）  </li>
</ul>
<hr>
<h1 id="NOTE"><a href="#NOTE" class="headerlink" title="NOTE"></a>NOTE</h1><ul>
<li>异或运算是自己的逆运算 a ^ b = c 那么 b = a ^ c a = b ^ c</li>
<li>异或运算实在统计一个数相关位的奇偶性</li>
<li>如和让输出最后没有空格 加上 i==0 || printf(“ “);</li>
<li>如何判断奇偶数的个数 cnt += !(val % 2);  </li>
<li>c语言中 val % 2 等价于 val &amp; 1  val &amp; 3 = val % 4    val &amp; 7 = val % 8</li>
<li>C语言运算符运行效率 位运算 &lt; 加减 &lt; 乘 &lt; 除 &lt; 取模</li>
</ul>
<figure class="highlight perl"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">&#123;</span><br><span class="line">    j == <span class="number">0</span> || <span class="keyword">printf</span>(<span class="string">&quot; &quot;</span>); <span class="regexp">//</span>在行尾添加空格的方法</span><br><span class="line">    <span class="keyword">printf</span>(<span class="string">&quot;%d&quot;</span>, i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>C</category>
      </categories>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2021/03/28/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><span id="more"></span>
<h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
  </entry>
</search>
